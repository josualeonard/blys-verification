(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{30:function(e,t,s){},37:function(e,t,s){},38:function(e,t,s){"use strict";s.r(t);var i=s(1),a=s(0),n=s.n(a),r=s(14),c=s.n(r),o=(s(30),s(10)),u=s(11),l=s(8),d=s(13),h=s(12),j=s(17),b=s(2),f=s(18),g=s.n(f),p=s(22),v=s(40),m=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).PORT,function(e){Object(d.a)(s,e);var t=Object(h.a)(s);function s(e){var i;return Object(o.a)(this,s),(i=t.call(this,e)).wrapper=void 0,i.state={digits:[],errors:[],isEmpty:!1,status:0,statusMessage:"",isVerifying:!1,isVerified:!1},i.state={digits:[],errors:[],isEmpty:!1,status:0,statusMessage:"",isVerifying:!1,isVerified:!1},i.setAppState=i.setAppState.bind(Object(l.a)(i)),i.handleFocus=i.handleFocus.bind(Object(l.a)(i)),i.handleKeyPress=i.handleKeyPress.bind(Object(l.a)(i)),i.handlePaste=i.handlePaste.bind(Object(l.a)(i)),i.handleKeyDown=i.handleKeyDown.bind(Object(l.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(l.a)(i)),i.wrapper=n.a.createRef(),i}return Object(u.a)(s,[{key:"setAppState",value:function(e,t){this.props.setAppState(e,t)}},{key:"handleKeyDown",value:function(e){var t=e.keyCode,s=e.target,i=parseInt(s.getAttribute("data-field-id"));switch(t){case 8:this.onFieldUpdate(s,-1,i,-1);break;case 37:case 38:this.gotoPrevField(i);break;case 39:case 40:this.gotoNextField(i)}}},{key:"handleKeyPress",value:function(e){var t=parseInt(e.key),s=e.target,i=parseInt(s.getAttribute("data-field-id"));this.onFieldUpdate(s,t,i)}},{key:"handlePaste",value:function(e){var t=e.clipboardData.getData("Text").replace(/[^0-9]/g,""),i=e.target,a=parseInt(i.getAttribute("data-field-id")),n=this.state.digits,r=this.state.errors;if(i.blur(),t.length>0)for(var c=0,o=1;o<=s.digits;o++){var u=document.getElementById("input"+o);if(o<a&&(n[o-1]||(n[o-1]="",r[o-1]=!0)),o>=a){var l=t[c];c++,isNaN(l)?n[o-1]||(n[o-1]="",r[o-1]=!0):(n[o-1]=l,r[o-1]=!1,u&&(u.value=l))}}}},{key:"onFieldUpdate",value:function(e,t,i){var a=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.state.digits,c=this.state.errors,o=this.state.isEmpty;if(!isNaN(i)){if(r.length<i)for(var u=1;u<=i;u++)r[u-1]||(r[u-1]=""),c[u-1]||(c[u-1]=!1);o=!1,isNaN(t)?(c[i-1]=!0,e.blur(),e.value="",setTimeout((function(){e.focus(),a.setState({status:-1,digits:r,errors:c,isEmpty:o})}),100)):(r[i-1]=t>=0?t.toString():"",c[i-1]=!1,this.setState({status:0,digits:r,errors:c,isEmpty:o},(function(){e.blur(),e.value=t>=0?t:"",setTimeout((function(){n>0?a.gotoNextField(i,i===s.digits):a.gotoPrevField(i)}),50)})))}}},{key:"gotoNextField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.getElementById("input"+(e+1<=s.digits?e+1:e));i&&(i.blur(),t||setTimeout((function(){i.focus()}),50))}},{key:"gotoPrevField",value:function(e){var t=document.getElementById("input"+(e-1>=1?e-1:e));t&&(t.blur(),setTimeout((function(){t.focus()}),50))}},{key:"handleFocus",value:function(e){this.state.isVerifying?e.target.blur():(this.setState({status:0}),e.target.select())}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var i=this.state.digits,a=this.state.errors,n=!0,r=0;if(i.length<s.digits){n=!1;for(var c=1;c<=s.digits;c++)(!i[c-1]||i[c-1].length<=0)&&(a[c-1]=!0,r++)}else for(var o=1;o<=i.length;o++)i[o-1].length<=0&&(n=!1,a[o-1]=!0);return n?this.setState({status:0,isVerifying:!0},(function(){t.verify().then((function(e){var s=e.body||{},i="success"===(s.status||""),a=s.message||"";t.setState({isVerifying:!1,status:i?1:-3,statusMessage:a},(function(){i&&setTimeout((function(){t.setAppState(i,a),t.setState({isVerified:!0})}),2e3)}))}))})):this.setState({status:-2,errors:a,isEmpty:r===s.digits}),!1}},{key:"verify",value:function(){var e=Object(p.a)(g.a.mark((function e(){var t,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.digits.join(""),e.next=3,fetch("/api/v1.0/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t})});case 3:return s=e.sent,e.next=6,s.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=document.getElementById("input1");e&&e.focus()}},{key:"message",value:function(){switch(this.state.status){case-1:return"Invalid input, only use number";case-2:return this.state.isEmpty?"Verification code cannot be empty":"Incomplete verification code";case-3:case 1:return this.state.statusMessage}return""}},{key:"render",value:function(){var e=this;return this.state.isVerified?Object(i.jsx)(b.a,{to:{pathname:"/success"}}):Object(i.jsx)(a.Fragment,{children:Object(i.jsxs)("div",{className:"form-container"+(this.state.isVerifying?" verifying":""),children:[Object(i.jsxs)("form",{id:"verification",className:"form",onSubmit:this.handleSubmit,children:[Object(i.jsx)(v.a,{in:0!==this.state.status,timeout:300,classNames:"alert",unmountOnExit:!0,children:Object(i.jsx)("div",{className:"alert",children:Object(i.jsx)("h3",{className:this.state.status>0?"success":"error",children:this.message()})})}),Object(i.jsx)("h1",{className:"line",children:"Verification code:"}),Object(i.jsx)("div",{className:"line",children:Array.from(Array(6),(function(t,s){return Object(i.jsx)("input",{id:"input"+(s+1),"data-field-id":s+1,type:"text",className:e.state.errors.length>=s&&e.state.errors[s]?"error":"",defaultValue:e.state.digits.length>=s?e.state.digits[s]:"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,onKeyPress:e.handleKeyPress,onPaste:e.handlePaste,onKeyDown:e.handleKeyDown,onFocus:e.handleFocus},s+1)}))}),Object(i.jsx)("div",{className:"line",children:this.state.isVerifying?Object(i.jsx)("div",{className:"submit",children:Object(i.jsxs)("div",{className:"lds-ellipsis",children:[Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{})]})}):Object(i.jsx)("button",{type:"submit",children:"Submit"})})]}),Object(i.jsxs)("div",{className:"explanation",children:[Object(i.jsx)("p",{children:"The code RULE is 6 digits long AND last digit NOT 7"}),Object(i.jsx)("p",{children:"User able to both manually enter the digits or paste the code from clipboard"}),Object(i.jsx)("p",{children:"Successful verification will bring user to success page"})]})]})})}}]),s}(a.Component));m.digits=6;var O=function(e){Object(d.a)(s,e);var t=Object(h.a)(s);function s(e){var i;return Object(o.a)(this,s),(i=t.call(this,e)).state={},i}return Object(u.a)(s,[{key:"render",value:function(){return Object(i.jsx)(a.Fragment,{children:Object(i.jsx)("div",{className:"form-container",children:Object(i.jsx)("div",{className:"form",children:this.props.isLogin?Object(i.jsxs)(a.Fragment,{children:[Object(i.jsx)("h1",{className:"line",children:this.props.statusMessage}),Object(i.jsx)("h3",{className:"line",children:"You have entered the correct verification code"})]}):Object(i.jsxs)(a.Fragment,{children:[Object(i.jsx)("h1",{className:"line",children:"You are not verified yet"}),Object(i.jsx)("h3",{className:"line",children:Object(i.jsx)("a",{href:"/",className:"link",children:"Reauthenticate"})})]})})})})}}]),s}(a.Component),y=(s(37),function(e){Object(d.a)(s,e);var t=Object(h.a)(s);function s(e){var i;return Object(o.a)(this,s),(i=t.call(this,e)).state={isLogin:!1,statusMessage:""},i.state={isLogin:!1,statusMessage:"Not authenticated"},i.setAppState=i.setAppState.bind(Object(l.a)(i)),i}return Object(u.a)(s,[{key:"setAppState",value:function(e,t){this.setState({isLogin:e,statusMessage:t})}},{key:"render",value:function(){return Object(i.jsx)(a.Fragment,{children:Object(i.jsx)(j.a,{children:Object(i.jsxs)(b.d,{children:[Object(i.jsx)(b.b,{path:"/success",children:Object(i.jsx)(O,{isLogin:this.state.isLogin,statusMessage:this.state.statusMessage})}),Object(i.jsx)(b.b,{path:"/",children:Object(i.jsx)(m,{setAppState:this.setAppState})})]})})})}}]),s}(a.Component)),x=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,41)).then((function(t){var s=t.getCLS,i=t.getFID,a=t.getFCP,n=t.getLCP,r=t.getTTFB;s(e),i(e),a(e),n(e),r(e)}))};c.a.render(Object(i.jsx)(n.a.StrictMode,{children:Object(i.jsx)(y,{})}),document.getElementById("root")),x()}},[[38,1,2]]]);
//# sourceMappingURL=main.31846a7d.chunk.js.map